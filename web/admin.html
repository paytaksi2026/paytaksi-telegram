<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PayTaksi Admin Paneli</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#0b1220;color:#e5e7eb}
    header{padding:14px 16px;background:#111827;position:sticky;top:0}
    .wrap{max-width:980px;margin:0 auto;padding:16px}
    .card{background:#111827;border:1px solid #1f2937;border-radius:12px;padding:14px;margin:12px 0}
    h1{font-size:18px;margin:0}
    small{color:#9ca3af}
    button{padding:10px 12px;border-radius:10px;border:0;background:#22c55e;color:#052e14;font-weight:700}
    input{width:100%;padding:10px;border-radius:10px;border:1px solid #374151;background:#0b1220;color:#e5e7eb}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:720px){.row{grid-template-columns:1fr}}
    .err{color:#fca5a5}
    pre{white-space:pre-wrap;word-break:break-word;background:#0b1220;border:1px solid #374151;border-radius:10px;padding:10px}
  </style>
</head>
<body>
  <header><div class="wrap"><h1>ðŸ§° PayTaksi Admin Paneli</h1><small>Mini App (Render)</small></div></header>
  <div class="wrap">
    <div class="card">
      <div><b>API BASE URL</b> (mÉ™s: https://paytaksi-telegram-wlig.onrender.com)</div>
      <input id="api" placeholder="https://..." />
      <div style="height:10px"></div>
      <button onclick="load()">Yoxla</button>
      <div id="out" style="margin-top:10px"></div>
    </div>

    <div class="row">
      <div class="card">
        <b>Health</b>
        <pre id="health">-</pre>
      </div>
      <div class="card">
        <b>Drivers</b>
        <pre id="drivers">-</pre>
      </div>
    </div>
  </div>

<script>
function getBase(){
  const saved = localStorage.getItem('PAYTAKSI_API_BASE') || '';
  const el = document.getElementById('api');
  const def = (window.location && window.location.origin) ? window.location.origin : '';

  // Auto-fill with the current origin so the user doesn't have to type URL in Telegram Mini App.
  if(!el.value) el.value = saved || def;

  const base = (el.value || saved || def || '').replace(/\/$/,'');
  if(base) localStorage.setItem('PAYTAKSI_API_BASE', base);
  return base;
}
async function load(){
  const base = getBase();
  localStorage.setItem('PAYTAKSI_API_BASE', base);
  const out = document.getElementById('out');
  out.textContent = '';
  if(!base){ out.innerHTML = '<div class="err">API URL yazÄ±n.</div>'; return; }
  try{
    const h = await fetch(base + '/health').then(r=>r.text());
    document.getElementById('health').textContent = h;
  }catch(e){
    document.getElementById('health').textContent = 'XÉ™ta: ' + e;
  }
  try{
    const d = await fetch(base + '/api/drivers').then(r=>r.text());
    document.getElementById('drivers').textContent = d;
  }catch(e){
    document.getElementById('drivers').textContent = 'XÉ™ta: ' + e;
  }
  out.innerHTML = '<small>HazÄ±r âœ…</small>';
}
load();
</script>
</body>
</html>
